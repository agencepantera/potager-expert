---
interface Props {
  title: string;
  excerpt: string;
  date: string;
  image: string;
  slug: string;
  category: string;
  author: string;
}

const { title, excerpt, date, image, slug, category, author } = Astro.props;

// Formater la date
const formattedDate = new Date(date).toLocaleDateString('fr-FR', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});

// Obtenir le slug de la catégorie pour le lien
const categorySlug = category.toLowerCase().replace(/\s+/g, '-').replace(/&/g, 'et');

// Générer les chemins des images optimisées
const imageBaseName = image.split('/').pop().split('.')[0];
const imageExt = image.split('.').pop();
const optimizedImages = {
  mobile: `/images/optimized/${imageBaseName}-mobile.${imageExt}`,
  tablet: `/images/optimized/${imageBaseName}-tablet.${imageExt}`,
  desktop: `/images/optimized/${imageBaseName}-desktop.${imageExt}`,
};
---

<article class="group">
  <a href={`/blog/${slug}`} class="block">
    <!-- Image -->
    <div class="aspect-video rounded-2xl overflow-hidden mb-4 border border-leaf-400/50">
      <img
        src={optimizedImages.desktop}
        srcset={`${optimizedImages.mobile} 640w, ${optimizedImages.tablet} 1024w, ${optimizedImages.desktop} 1280w`}
        sizes="(max-width: 640px) 640px, (max-width: 1024px) 1024px, 1280px"
        alt={title}
        class="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-300"
        loading="lazy"
      />
    </div>

    <!-- Contenu -->
    <div class="space-y-3">
      <!-- Catégorie -->
      <div class="inline-block px-3 py-1 rounded-full bg-leaf-100/70 border border-leaf-400/50 text-leaf-800 text-sm">
        {category}
      </div>

      <!-- Titre -->
      <h2 class="text-xl font-display font-bold text-leaf-900 group-hover:text-leaf-700 transition-colors duration-200">
        {title}
      </h2>

      <!-- Description -->
      <p class="text-leaf-700 line-clamp-2">
        {excerpt}
      </p>

      <!-- Métadonnées -->
      <div class="flex items-center space-x-4 text-sm text-leaf-600">
        <div class="flex items-center space-x-2">
          <span>{author}</span>
        </div>
        <span>•</span>
        <time datetime={date}>{formattedDate}</time>
      </div>
    </div>
  </a>
</article>
